From 748c9fecbea033aa244c9f6b70053468f1f78db9 Mon Sep 17 00:00:00 2001
From: Todd Short <tshort@akamai.com>
Date: Fri, 30 Aug 2019 09:47:48 -0400
Subject: [PATCH 14/63] QUIC: Correctly disable middlebox compat

---
 ssl/ssl_quic.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/ssl/ssl_quic.c b/ssl/ssl_quic.c
index 0017d1eba9..a76c24eac6 100644
--- a/ssl/ssl_quic.c
+++ b/ssl/ssl_quic.c
@@ -173,7 +173,7 @@ int SSL_CTX_set_quic_method(SSL_CTX *ctx, const SSL_QUIC_METHOD *quic_method)
         break;
     }
     ctx->quic_method = quic_method;
-    ctx->options &= SSL_OP_ENABLE_MIDDLEBOX_COMPAT;
+    ctx->options &= ~SSL_OP_ENABLE_MIDDLEBOX_COMPAT;
     return 1;
 }
 
@@ -189,7 +189,7 @@ int SSL_set_quic_method(SSL *ssl, const SSL_QUIC_METHOD *quic_method)
         break;
     }
     ssl->quic_method = quic_method;
-    ssl->options &= SSL_OP_ENABLE_MIDDLEBOX_COMPAT;
+    ssl->options &= ~SSL_OP_ENABLE_MIDDLEBOX_COMPAT;
     return 1;
 }
 
-- 
2.42.0

